{"version":3,"sources":["utils/request.js","pages/login/index.css","pages/login/index.js"],"names":["service","axios","create","timeout","withCredentials","interceptors","request","use","config","console","log","err","Promise","reject","response","status","data","error","module","exports","TabPane","Tabs","Login","props","Form","useForm","form","useConnect","storeContext","dispatch","state","className","styles","login","defaultActiveKey","tab","key","form_wrap","name","onFinish","values","window","Bmob","User","username","password","then","res","message","success","type","params","setTimeout","history","goBack","catch","warning","slice","Item","rules","required","placeholder","prefix","Password","htmlType","register","warn","pattern"],"mappings":"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","file":"static/js/Page-login.2eb4ed7d.chunk.js","sourcesContent":["import axios from 'axios'\r\n\r\n// 创建axios实例\r\nconst service = axios.create({\r\n//   baseURL: process.env.BASE_API, // api的base_url\r\n  timeout: 200000, // 请求超时时间\r\n  withCredentials: true, // 选项表明了是否是跨域请求\r\n})\r\nservice.interceptors.request.use(config => {\r\n//   Toast.loading('加载中',1)              // loading组件，显示文字加载中，自动关闭延时1s\r\n  console.log('request go', config);\r\n  return config;\r\n}, err => {\r\n  console.log('请求失败')\r\n  return Promise.reject(err)\r\n})\r\n// 拦截响应\r\nservice.interceptors.response.use(config => {\r\n//   Toast.hide()                             // 销毁Toast组件\r\n  console.log('response get')\r\n  return config;\r\n}, err => {\r\n  console.log('响应失败')\r\n  return Promise.reject(err)\r\n})\r\n\r\n// respone拦截器\r\nservice.interceptors.response.use(\r\n  response => {\r\n    /**\r\n    * code为非000000是抛错 可结合自己业务进行修改\r\n    */\r\n    if (response.status === 200 && response.data) {\r\n      return response.data\r\n    }\r\n    return response\r\n  },\r\n  error => {\r\n    return Promise.reject(error)\r\n  }\r\n)\r\nexport default service\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"login\":\"src-pages-login-index-login-3AR6N8jC\",\"form_wrap\":\"src-pages-login-index-form_wrap-2XAK-sIW\",\"reset_btn\":\"src-pages-login-index-reset_btn-1M34Vpbu\"};","/*\r\n * @Author: mikey.liudekang\r\n * @Date: 2019-09-17 20:58:00\r\n * @Last Modified by: mikey.liudekang\r\n * @Last Modified time: 2020-06-09 22:07:07\r\n */\r\nimport React, { useForm, useEffect } from 'react';\r\n\r\nimport { Form, Input, Button, Tabs, message } from 'antd';\r\nimport useConnect from 'Src/contextRedux/useConext';\r\nimport { storeContext } from 'Src/contextRedux/store';\r\nimport { UserOutlined, LockOutlined, WhatsAppOutlined, VerifiedOutlined, MailOutlined } from '@ant-design/icons';\r\nimport service from 'Src/utils/request';\r\n\r\nimport styles from './index.css'\r\n\r\n// const TestContext= React.createContext({});\r\n\r\nconst { TabPane, } = Tabs;\r\nconst layout = {\r\n  labelCol: { span: 8, },\r\n  wrapperCol: { span: 16, },\r\n};\r\nconst tailLayout = {\r\n  wrapperCol: { offset: 8, span: 16, },\r\n};\r\n\r\nconst Login = (props) => {\r\n  const [form] = Form.useForm();\r\n  const { state, dispatch, } = useConnect(storeContext);\r\n  // console.log(8888, state, dispatch,)\r\n  // useEffect(() => {\r\n  //   console.log(222, window.Bmob, props)\r\n  //   // Bmob.User.users().then(res => {\r\n  //   //   console.log(res)\r\n  //   // }).catch(err => {\r\n  //   //   console.log(err)\r\n  //   // })\r\n\r\n  //   const current = window.Bmob.User.current()\r\n  //   console.log(111, current)\r\n  // }, [])\r\n  const onLoginFinish = values => {\r\n    console.log('Success:', values);\r\n    window.Bmob.User.login(values.username, values.password).then(res => {\r\n      console.log(res)\r\n      message.success('登录成功');\r\n      dispatch({ type: 'change_userName', params: values.username, })\r\n      setTimeout(() => {\r\n        // props.history.goBack()\r\n        props?.history?.goBack()\r\n        // window.history.back()\r\n        // Bmob.User.users().then(res => {\r\n        //   console.log(677777, res)\r\n        // }).catch(err => {\r\n        //   console.log(err)\r\n        // })\r\n      }, 500)\r\n    }).catch(err => {\r\n      console.log(err)\r\n      if (typeof err.error === 'string') {\r\n        message.warning(err.error.slice(0, 300))\r\n      } else {\r\n        message.error('操作失败')\r\n      }\r\n    });\r\n  };\r\n\r\n  const onFinishFailed = errorInfo => {\r\n    console.log('Failed:', errorInfo);\r\n  };\r\n  const onRegisterFinish = (values) => {\r\n    console.log(66, values);\r\n    window.Bmob.User.register(values).then(res => {\r\n      message.success('注册成功');\r\n      dispatch({ type: 'change_userName', params: values.username, })\r\n      setTimeout(() => {\r\n        props?.history?.goBack()\r\n      }, 500)\r\n    }).catch(err => {\r\n      if (typeof err.error === 'string') {\r\n        message.warning(err.error.slice(0, 300))\r\n      } else {\r\n        message.error('操作失败')\r\n      }\r\n      console.warn(44, err)\r\n    });\r\n  };\r\n  const getsmsCodeFn = () => {\r\n    const phonee = form.getFieldValue('phone')\r\n    console.log('444:', phonee);\r\n  };\r\n  return (\r\n    <div className={styles.login} >\r\n      <Tabs\r\n        defaultActiveKey='login'\r\n      // onChange={callback}\r\n      >\r\n        <TabPane tab='登录' key='login'>\r\n          <Form\r\n            className={styles.form_wrap}\r\n            form={form}\r\n            name='login'\r\n            // initialValues={{ remember: true, }}\r\n            onFinish={onLoginFinish}\r\n          // onFinishFailed={onFinishFailed}\r\n          >\r\n            <Form.Item\r\n              // label='用户名'\r\n              name='username'\r\n              rules={[{ required: true, message: '请输入用户名或者手机号', }]}\r\n            >\r\n              <Input\r\n                placeholder='请输入用户名或者手机号'\r\n                prefix={<UserOutlined className='site-form-item-icon' />}\r\n              />\r\n            </Form.Item>\r\n\r\n            <Form.Item\r\n              // label='密码'\r\n              name='password'\r\n              rules={[{ required: true, message: '请输入密码', }]}\r\n            >\r\n              <Input.Password\r\n                placeholder='请输入密码'\r\n                prefix={<LockOutlined className='site-form-item-icon' />}\r\n              />\r\n            </Form.Item>\r\n\r\n            <Form.Item >\r\n              <Button type='primary' htmlType='submit'>登录</Button>\r\n              {/* <Button className={styles.reset_btn} onClick={onReset}>重置</Button> */}\r\n            </Form.Item>\r\n          </Form>\r\n\r\n        </TabPane>\r\n\r\n        <TabPane tab='注册' key='register'>\r\n          <Form\r\n            className={styles.form_wrap}\r\n            form={form}\r\n            name='register'\r\n            // initialValues={{ remember: true, }}\r\n            onFinish={onRegisterFinish}\r\n          // onFinishFailed={onFinishFailed}\r\n          >\r\n            <Form.Item\r\n              // label='用户名'\r\n              name='username'\r\n              rules={[{ required: true, message: '请输入用户名', }]}\r\n            >\r\n              <Input\r\n                placeholder='请输入用户名'\r\n                prefix={<UserOutlined className='site-form-item-icon' />}\r\n              />\r\n            </Form.Item>\r\n            <Form.Item\r\n              // label='邮箱'\r\n              name='email'\r\n              rules={[\r\n                {\r\n                  type: 'email',\r\n                  message: '请输入正确格式的邮箱',\r\n                },\r\n                {\r\n                  required: true,\r\n                  message: '请输入邮箱',\r\n                },\r\n              ]}\r\n            >\r\n              <Input\r\n                placeholder='请输入邮箱'\r\n                prefix={<MailOutlined className='site-form-item-icon' />}\r\n              />\r\n            </Form.Item>\r\n            <Form.Item\r\n              // label='手机号'\r\n              name='phone'\r\n              rules={[\r\n                {\r\n                  pattern: /^1[3456789]\\d{9}$/,\r\n                  message: '请输入正确格式的手机号',\r\n                },\r\n                {\r\n                  required: false,\r\n                  message: '请输入手机号',\r\n                },\r\n              ]}\r\n            >\r\n              <Input\r\n                placeholder='请输入手机号'\r\n                prefix={<WhatsAppOutlined className='site-form-item-icon' />} />\r\n            </Form.Item>\r\n            {/* <Form.Item\r\n              // label='验证码'\r\n              name='smsCode'\r\n              rules={[{ required: true, message: '请输入验证码', }]}\r\n            >\r\n              <Input.Search\r\n                enterButton='获取验证码'\r\n                placeholder='请输入手机验证码'\r\n                onSearch={getsmsCodeFn}\r\n                prefix={<VerifiedOutlined className='site-form-item-icon' />}\r\n              />\r\n            </Form.Item> */}\r\n            <Form.Item\r\n              // label='密码'\r\n              name='password'\r\n              rules={[{ required: true, message: '请输入密码', }]}\r\n            >\r\n              <Input.Password\r\n                placeholder='请输入密码'\r\n                prefix={<LockOutlined className='site-form-item-icon' />}\r\n              />\r\n            </Form.Item>\r\n\r\n            <Form.Item >\r\n              <Button type='primary' htmlType='submit'>注册</Button>\r\n            </Form.Item>\r\n          </Form>\r\n\r\n        </TabPane>\r\n      </Tabs>\r\n\r\n    </div>\r\n  )\r\n}\r\nexport default Login\r\n"],"sourceRoot":""}